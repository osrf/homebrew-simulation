name: brew test-bot
on:
  push:
    branches: master
  pull_request:
jobs:
  test-bot:
    runs-on: ubuntu-latest
    env:
      HOMEBREW_FORCE_VENDOR_RUBY: 1
    steps:
      - name: Activate Homebrew
        if: runner.os == 'Linux'
        run: echo "/home/linuxbrew/.linuxbrew/bin" >> "$GITHUB_PATH"

      - name: Set up Homebrew
        id: set-up-homebrew
        uses: Homebrew/actions/setup-homebrew@master

      - run: brew test-bot --only-cleanup-before

      - run: brew test-bot --only-setup

      - run: brew test-bot --fail-fast --tap=osrf/simulation --only-tap-syntax
