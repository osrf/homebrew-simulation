Build | Status
-- | --
macOS 10.15 GitHub action | [![Build Status](![brew test-bot](https://github.com/osrf/homebrew-simulation/workflows/brew%20test-bot/badge.svg?branch=master&event=push))

homebrew-simulation
===================

Homebrew tap for osrf simulation software

To use:

    brew tap osrf/simulation
    brew install ignition-citadel

## Bottle status

### Ignition Citadel

* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_cmake2-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-citadel/job/ignition_cmake2-install_bottle-homebrew-amd64/)           [ignition_cmake2](https://build.osrfoundation.org/view/ign-citadel/job/ignition_cmake2-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_tools1-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-citadel/job/ignition_tools1-install_bottle-homebrew-amd64/)           [ignition_tools1](https://build.osrfoundation.org/view/ign-citadel/job/ignition_tools1-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_math6-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-citadel/job/ignition_math6-install_bottle-homebrew-amd64/)             [ignition_math6](https://build.osrfoundation.org/view/ign-citadel/job/ignition_math6-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_common3-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-citadel/job/ignition_common3-install_bottle-homebrew-amd64/)         [ignition_common3](https://build.osrfoundation.org/view/ign-citadel/job/ignition_common3-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_msgs5-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-citadel/job/ignition_msgs5-install_bottle-homebrew-amd64/)             [ignition_msgs5](https://build.osrfoundation.org/view/ign-citadel/job/ignition_msgs5-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_fuel-tools4-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-citadel/job/ignition_fuel-tools4-install_bottle-homebrew-amd64/) [ignition_fuel-tools4](https://build.osrfoundation.org/view/ign-citadel/job/ignition_fuel-tools4-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_plugin1-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-citadel/job/ignition_plugin1-install_bottle-homebrew-amd64/)         [ignition_plugin1](https://build.osrfoundation.org/view/ign-citadel/job/ignition_plugin1-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_transport8-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-citadel/job/ignition_transport8-install_bottle-homebrew-amd64/)   [ignition_transport8](https://build.osrfoundation.org/view/ign-citadel/job/ignition_transport8-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_physics2-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-citadel/job/ignition_physics2-install_bottle-homebrew-amd64/)       [ignition_physics2](https://build.osrfoundation.org/view/ign-citadel/job/ignition_physics2-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_rendering3-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-citadel/job/ignition_rendering3-install_bottle-homebrew-amd64/)   [ignition_rendering3](https://build.osrfoundation.org/view/ign-citadel/job/ignition_rendering3-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_gui3-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-citadel/job/ignition_gui3-install_bottle-homebrew-amd64/)               [ignition_gui3](https://build.osrfoundation.org/view/ign-citadel/job/ignition_gui3-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_sensors3-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-citadel/job/ignition_sensors3-install_bottle-homebrew-amd64/)       [ignition_sensors3](https://build.osrfoundation.org/view/ign-citadel/job/ignition_sensors3-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_gazebo3-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-citadel/job/ignition_gazebo3-install_bottle-homebrew-amd64/)         [ignition_gazebo3](https://build.osrfoundation.org/view/ign-citadel/job/ignition_gazebo3-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_launch2-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-citadel/job/ignition_launch2-install_bottle-homebrew-amd64/)         [ignition_launch2](https://build.osrfoundation.org/view/ign-citadel/job/ignition_launch2-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_citadel-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-citadel/job/ignition_citadel-install_bottle-homebrew-amd64/)         [ignition_citadel](https://build.osrfoundation.org/view/ign-citadel/job/ignition_citadel-install_bottle-homebrew-amd64/)

### Ignition Blueprint

* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_cmake2-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_cmake2-install_bottle-homebrew-amd64/)           [ignition_cmake2](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_cmake2-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_tools1-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_tools1-install_bottle-homebrew-amd64/)           [ignition_tools1](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_tools1-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_math6-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_math6-install_bottle-homebrew-amd64/)             [ignition_math6](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_math6-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_common3-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_common3-install_bottle-homebrew-amd64/)         [ignition_common3](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_common3-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_msgs4-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_msgs4-install_bottle-homebrew-amd64/)             [ignition_msgs4](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_msgs4-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_fuel-tools3-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_fuel-tools3-install_bottle-homebrew-amd64/) [ignition_fuel-tools3](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_fuel-tools3-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_plugin1-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_plugin1-install_bottle-homebrew-amd64/)         [ignition_plugin1](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_plugin1-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_transport7-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_transport7-install_bottle-homebrew-amd64/)   [ignition_transport7](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_transport7-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_physics1-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_physics1-install_bottle-homebrew-amd64/)       [ignition_physics1](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_physics1-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_rendering2-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_rendering2-install_bottle-homebrew-amd64/)   [ignition_rendering2](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_rendering2-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_gui2-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_gui2-install_bottle-homebrew-amd64/)               [ignition_gui2](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_gui2-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_sensors2-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_sensors2-install_bottle-homebrew-amd64/)       [ignition_sensors2](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_sensors2-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_gazebo2-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_gazebo2-install_bottle-homebrew-amd64/)         [ignition_gazebo2](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_gazebo2-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_launch1-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_launch1-install_bottle-homebrew-amd64/)         [ignition_launch1](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_launch1-install_bottle-homebrew-amd64/)
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ignition_blueprint-install_bottle-homebrew-amd64)](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_blueprint-install_bottle-homebrew-amd64/)         [ignition_blueprint](https://build.osrfoundation.org/view/ign-blueprint/job/ignition_blueprint-install_bottle-homebrew-amd64/)

## To build bottles

The https://build.osrfoundation.org jenkins instance is used for building bottles with the following job
(configured in [brew_release.dsl](https://github.com/ignition-tooling/release-tools/blob/master/jenkins-scripts/dsl/brew_release.dsl)):

* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=generic-release-homebrew_bottle_builder)](https://build.osrfoundation.org/job/generic-release-homebrew_bottle_builder/) https://build.osrfoundation.org/job/generic-release-homebrew_bottle_builder/

This jenkins job takes a `PULL_REQUEST_URL` as an input parameter and uses the
[homebrew_bottle_creation.bash](https://github.com/ignition-tooling/release-tools/blob/master/jenkins-scripts/lib/homebrew_bottle_creation.bash)
script from [ignition-tooling/release-tools](https://github.com/ignition-tooling/release-tools),
which invokes [brew test-bot](https://github.com/Homebrew/homebrew-test-bot)
with the [following command](https://github.com/ignition-tooling/release-tools/blob/d6417a5c1be87238f155683e2ef70b2e784eb31c/jenkins-scripts/lib/homebrew_bottle_creation.bash#L38-L40):

~~~
brew test-bot --tap=osrf/simulation \
  --root-url=https://osrf-distributions.s3.amazonaws.com/bottles-simulation \
  --ci-pr ${PULL_REQUEST_URL}
~~~

If you are using the `release.py` script from [osrf/release-tools](https://bitbucket.org/osrf/release-tools),
a Jenkins bottle builder job will be started automatically.
Otherwise, create a pull request to this repository and paste the pull request url into the `PULL_REQUEST_URL`
build parameter.

The job is not configured to run automatically without the `release.py` script
since it will automatically upload bottles to s3 once it is finished,
where they are immediately available for public download.
This process differs from the approach taken by
[homebrew/homebrew-core](https://github.com/Homebrew/homebrew-core)
whose bottles are hosted at Bintray, which has a
[different publishing mechanism](https://www.jfrog.com/confluence/display/BT/Managing+Uploaded+Content#ManagingUploadedContent-Publishing)
than s3.
Files uploaded to Bintray are not immediately available for public download;
they must first be published.
If they are not published within 7 days of upload, they are automatically deleted.
The homebrew-core CI jobs will build bottles for any incoming pull request,
which will upload bottles directly to bintray, but these bottles will not be
publicly available unless the pull request is merged by a homebrew maintainer
within 7 days.

The jenkins job currently builds bottles for macOS 10.13 `high_sierra` and 10.14 `mojave`
using the following job configurations:

* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=generic-release-homebrew_bottle_builder%2Flabel%3Dosx_highsierra)](https://build.osrfoundation.org/job/generic-release-homebrew_bottle_builder/label=osx_highsierra/) https://build.osrfoundation.org/job/generic-release-homebrew_bottle_builder/label=osx_highsierra
* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=generic-release-homebrew_bottle_builder%2Flabel%3Dosx_mojave)](https://build.osrfoundation.org/job/generic-release-homebrew_bottle_builder/label=osx_mojave/) https://build.osrfoundation.org/job/generic-release-homebrew_bottle_builder/label=osx_mojave

If the bottle building job finishes without errors for each build configuration,
it will trigger a subsequent [repository_uploader_ng](https://build.osrfoundation.org/job/repository_uploader_ng/)
job that uploads the bottles to s3
and a [generic-release-homebrew_pr_bottle_hash_updater](https://build.osrfoundation.org/job/generic-release-homebrew_pr_bottle_hash_updater/)
job that commits the changes in bottle `sha256` values to the pull request branch
using [this script](https://github.com/ignition-tooling/release-tools/blob/master/jenkins-scripts/lib/homebrew_bottle_pullrequest.bash).

The GitHub build status that appears in each PR is currently broken.
It used to check that bottles could be downloaded properly, but recent
changes to [brew test-bot](https://github.com/Homebrew/homebrew-test-bot)
have disabled this feature.
